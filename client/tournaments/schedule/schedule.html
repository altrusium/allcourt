<template name="schedule">
	{{> tabs}}
	{{setTab 'tournaments'}}
	<ul class="breadcrumb">
    <li><a href="/tournament/{{activeTournamentSlug}}">Details</a> <span class="divider">|</span></li>
    <li><a href="/tournament/{{activeTournamentSlug}}/roles">Roles</a> <span class="divider">|</span></li>
    <li><a href="/tournament/{{activeTournamentSlug}}/teams">Teams</a> <span class="divider">|</span></li>
    <li><a href="/tournament/{{activeTournamentSlug}}/registrants">Registrants</a> <span class="divider">|</span></li>
    <li><a href="/tournament/{{activeTournamentSlug}}/shifts">Volunteer Shifts</a> <span class="divider">|</span></li>
		<li class="active">Volunteer Schedule</li>
	</ul>
	{{> userMessages}}
  <div class="row">
    <div class="span4">
      <h2 class="column-header"><small>Manage team schedules</small></h2>
      <form class="form-vertical">
        <div class="control-group">
          <label for="team" class="control-label">Team</label>
          <div class="controls">
            <select id="team">
              {{#each teams}}
              <option value="{{teamId}}" {{markSelectedTeam}}>{{teamName}}</option>
              {{/each}}
            </select>
          </div>
        </div>
        <div class="control-group">
          <label for="day" class="control-label">Day</label>
          <div class="controls">
            <select id="day">
              <option value="">All Days</option>
              {{#each shifts.days}}
              <option value="{{date}}" {{markSelectedDay}}>{{dayOfWeek}}, {{dayOfMonth}}</option>
              {{/each}}
            </select>
          </div>
        </div>
        <div class="control-group">
          <label for="shift" class="control-label">Shift</label>
          <div class="controls">
            <select id="shift">
              <option value="">All Shifts</option>
              {{#each shifts.defs}}
              <option value="{{shiftDefId}}" {{markSelectedShift}}>{{shiftName}}</option>
              {{/each}}
            </select>
          </div>
        </div>
      </form>
    </div>

    {{#if showingAllDays}}
    <div class="span8">
      <h2 class="column-header"><small>All {{activeTeamName}} Shifts</small></h2>
      <p></p>
      <table class="table table-striped table-condensed">
        <thead>
          <tr>
            <td>
              Date<br>
              and<br>
              Shift 
            </td>
            {{#each shifts.defs}}
            <th>
              {{shiftName}}<br>
              {{startTime}}<br>
              {{endTime}}
            </th>
            {{/each}}
          </tr>
        </thead>
        <tbody>
          {{#each shifts.days}}
          <tr>
            <td><strong>{{dayOfWeek}}<br>{{dayOfMonth}}</strong></td>
            {{#each activeShifts}}
            <td>
              <span class="shift-status" data-shift-id="{{shiftId}}">{{confirmedCount}}/{{count}}</span><br/>
              <div class="{{status}} status-marker"></div>
            </td>
            {{/each}}
          </tr>
          {{/each}}
        </tbody>
      </table>
    {{/if}}

    {{#if showingOneDay}}
    <div class="span8">
      <h2 class="column-header"><small>{{activeTeamName}} Shifts for {{activeDate}}</small></h2>
      <p></p>
      <table class="table table-condensed">
        <thead>
          <tr>
            <td>
              Shifts<br>
              for<br>
              {{weekDay}}
            </td>
            {{#each shifts.defs}}
            <th>
              {{shiftName}}<br>
              {{startTime}}<br>
              {{endTime}}
            </th>
            {{/each}}
          </tr>
        </thead>
        <tbody>
          <tr>
            <td></td>
            {{#each dayVolunteers}}
            <td>
	            {{#each confirmed}}
              <p class="confirmed" data-volunteer-id="{{userId}}">{{fullName}}</p>
	            {{/each}}
	            {{#each backedOut}}
              <p class="backed-out" data-volunteer-id="{{userId}}">{{fullName}}</p>
	            {{/each}}
	            {{#each keen}}
              <p class="keen" data-volunteer-id="{{userId}}">{{fullName}}</p>
	            {{/each}}
            </td>
            {{/each}}
          </tr>
        </tbody>
      </table>
    {{/if}}

    {{#if showingOneShift}}
    <div class="one-shift span8">
      <h2 class="column-header"><small>{{activeTeamName}} Shift for {{activeDate}} {{activeShiftTimes}}</small></h2>
      <p></p>
    	<div class="row">
    		<div class="span4">
          {{#each shiftVolunteers}}
            {{#each confirmed}}
            <p data-user-id="{{userId}}" data-action="remove">
            	<i class="action icon-remove" title="Remove"></i> 
            	<span class="confirmed">{{fullName}}</span>
            </p>
            {{/each}}
            {{#each backedOut}}
            <p data-user-id="{{userId}}" data-action="confirmRemove">
            	<i class="action icon-ok" title="Confirm"></i> 
            	<span class="backed-out">{{fullName}}</span>
            </p>
            {{/each}}
            {{#each keen}}
            <p data-user-id="{{userId}}" data-action="confirmAdd">
            	<i class="action icon-ok" title="Confirm"></i> 
            	<span class="keen">{{fullName}}</span>
            </p>
            {{/each}}
          {{/each}}
        </div>
        <div class="span4">
        	<!--
        	<p><a href="#" id="showAllShifts">Show all shifts</a><p>
	        </p><a href="#" id="showAllDays">Show all days</a></p>
		      -->
	        <div class="control-group">
	          <label for="search" class="control-label">Add an existing user</label>
	          <input id="search" type="text" placeholder="Partial name of user">
	        </div>
        </div>
      </div>
    </div>
    {{/if}}

    </div>
	</div>
</template>

<template name="setupShifts">
  {{> tabs}}
  {{setTab 'tournaments'}}
  <ul class="breadcrumb">
    <li><a href="/tournaments">Tournaments</a> <span class="divider">/</span></li>
    <li class="active">Shifts</li>
  </ul>
  {{> userMessages}}
  <div class="row">
    <div class="span5">
      <h2 class="column-header"><small>Manage shifts by role</small></h2> 
      <div class="row"><div class="span6"></div></div>
      <form class="form-vertical">
        <div class="control-group">
          <label for="tournament" class="control-label">Tournament</label>
          <div class="controls">
            <select id="tournament" class="span3">
              {{#each tournaments}}
              <option value="{{_id}}" {{markSelectedTournament}}>{{tournamentName}}</option>
              {{/each}}
            </select>
          </div>
        </div>
        {{#if noRolesYet}}
          <p>You must first setup at least one role <a href="/tournament/roles">here</a>.</p>
        {{else}}
          <div class="control-group">
            <label for="role" class="control-label">Role</label>
            <div class="controls">
              <select id="role" class="span3">
                {{#each roles}}
                <option value="{{roleId}}" {{markSelectedRole}}>{{roleName}}</option>
                {{/each}}
              </select>
            </div>
          </div>
          <div class="control-group">
            <label for="setupShiftsStartTime" class="control-label">Start time</label>
            <div class="controls">
              <div class="input-append bootstrap-timepicker-component">
                <input type="text" class="span2 timepicker-default" id="setupShiftsStartTime">
                <span class="add-on"><i class="icon-time"></i></span>
              </div>
            </div>
          </div>
          <div class="control-group">
            <label for="setupShiftsEndTime" class="control-label">End time</label>
            <div class="controls">
              <div class="input-append bootstrap-timepicker-component">
                <input type="text" class="span2 timepicker-default" id="setupShiftsEndTime">
                <span class="add-on"><i class="icon-time"></i></span>
              </div>
            </div>
          </div>
          <div class="control-group">
            <label for="shiftName" class="control-label">Name</label>
            <div class="controls">
              <input type="text" class="span2" id="shiftName" placeholder="AM1, PM1, etc.">
            </div>
          </div>
          <div class="control-group">
            <label for="shiftCount" class="control-label">Required volunteer count</label>
            <div class="controls">
              <input type="text" class="span1" id="shiftCount" placeholder="6">
            </div>
          </div>
          <div class="control-group">
            <div class="controls">
              <button type="button" id="addShift" class="btn btn-primary">Add Shift</button>
            </div>
          </div>
          <p>Next: <a href="">Add volunteers</a> or <a href="">assign them shifts</a></p>
        {{/if}}
      </form>
    </div>
    <div class="span7">
      {{#if shiftsToShow}}
      <h2 class="column-header"><small>{{activeRoleName}} Shifts</small></h2>
      <p></p>
      <table class="table table-striped table-condensed">
        <thead>
          <tr>
            <td>
              Date<br>
              and<br>
              Shift <i class="icon-info-sign" data-placement="right" data-trigger="hover" data-animation="true" data-title="Configuring Shifts" data-content="Adding a shift will add it to every day of the tournament. To adjust the number of volunteers needed on a particular shift, after adding the shift, select the count in the table."></i> 
            </td>
            {{#each shifts.defs}}
            <th>
              {{shiftName}} <i class="icon-remove" data-delete-shiftdef-id="{{shiftDefId}}"></i><br>
              {{startTime}}<br>
              {{endTime}}
            </th>
            {{/each}}
          </tr>
        </thead>
        <tbody>
          {{#each shifts.days}}
          <tr>
            <td><strong>{{dayOfWeek}}<br>{{dayOfMonth}}</strong></td>
            {{#each activeShifts}}
            <td>
              {{#if editingShift}}
                <div class="input-append" data-shift-id="{{shiftId}}">
                  <input type="text" class="shift span1" value="{{count}}">
                  <span class="add-on" data-save-shift-count><i class="icon-ok"></i></span>
                </div>
              {{else}}
                <span class="shift-count {{zeroClass}}" data-shift-id="{{shiftId}}">{{count}}</span>
              {{/if}}
            </td>
            {{/each}}
          </tr>
          {{/each}}
        </tbody>
      </table>
      {{/if}}
    </div>
  </div>
</template>

